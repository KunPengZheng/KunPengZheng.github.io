import{_ as F,x as H,r as n,O as M,aM as N,C as S,P as y,bh as G,o as p,c as h,d as b,w as P,a9 as B,J as V,M as A,h as I,aC as K,y as T,ag as C,F as U}from"./index-fdc685fa.js";import{i as $,E as z,P as J}from"./ic_empty_no_data_note-97eb05c9.js";import{a as O,G as j}from"./index-54e0da6e.js";const q={key:0},Q={__name:"LRGrid",props:{keyProp:"",columnNum:{type:Number,default:2},apiPromise:Function,dataConvert:Function,dataHook:Function,disabledRefresh:{type:Boolean,default:!1},disabledLoadMore:{type:Boolean,default:!1},disabledEmpty:{type:Boolean,default:!1},externalDataFlag:{type:Boolean,default:!1},arrKey:{type:String,default:"data"}},setup(k,{expose:D}){const a=k,r=H([]),c=n(null),s=n(!1),_=n(!1),m=n(!1),u=n(!1),i=n(!1),x=n(null),E=n($);M(()=>{a.externalDataFlag||(w(),!a.disabledLoadMore&&window.addEventListener("scroll",R,{passive:!0}))}),N(()=>{a.externalDataFlag||a.disabledLoadMore||window.removeEventListener("scroll",R,{passive:!0})});const L=S(()=>a.externalDataFlag?a.externalDataFlag:a.disabledRefresh);function R(){let t=x.value.clientHeight,l=document.documentElement.clientHeight,o=document.documentElement.scrollTop;o===0&&(t=1e4),t<=l+o&&g(!1)}function g(t){if(s.value||m.value)return;if(t)i.value=!1,u.value=!1,s.value=!0,m.value=!1;else{if(u.value)return;s.value=!1,m.value=!0}let l;t?l=1:c.value&&(l=Number(c.value.current_page)+1);const o=()=>{s.value=!1,_.value=!1,m.value=!1;const e=c.value;e?(u.value=Number(e.current_page)>=e.last_page&&y(e.data)<e.per_page||y(e.data)===0,u.value):u.value=!0},v=e=>a.dataConvert?a.dataConvert(e):e;a.apiPromise(l.toString()).then(e=>{if(c.value=e,e){const d=e[a.arrKey];s.value?(y(d)<=0&&(i.value=!0),r.value=v(d)):(r.value.push(...v(d)),G(r)),o(),t&&a.dataHook&&a.dataHook(e)}else s.value&&(i.value=!0),o()})}const w=()=>{g(!0)};return D({refresh:w,setData:t=>{r.value=t}}),(t,l)=>{const o=O,v=j,e=z,d=J;return p(),h("div",{ref_key:"scrollContainer",ref:x},[b(d,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=f=>_.value=f),onRefresh:l[1]||(l[1]=f=>g(!0)),disabled:L.value},{default:P(()=>[B(b(v,{border:!1,"column-num":a.columnNum,gutter:0},{default:P(()=>[(p(!0),h(V,null,A(r.value,f=>(p(),I(o,{key:f[k.keyProp]},{default:P(()=>[K(t.$slots,"default",T({ref_for:!0},f),void 0,!0)]),_:2},1024))),128))]),_:3},8,["column-num"]),[[C,!i.value]]),a.disabledEmpty?U("",!0):(p(),h("div",q,[B(b(e,{image:E.value,description:"暂无数据，请稍后再试～",class:"empty_img"},null,8,["image"]),[[C,i.value]])]))]),_:3},8,["modelValue","disabled"])],512)}}},ee=F(Q,[["__scopeId","data-v-8303c0f3"]]);export{ee as _};
