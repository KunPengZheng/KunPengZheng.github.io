import{_ as C,H,r as s,Q as N,aD as F,C as S,R as y,bc as M,o as v,c as h,d as b,w as R,J as w,N as G,O as V,h as A,b9 as I,x as K,M as D,B as T}from"./index-14c7bbbb.js";import{E as U,P as $}from"./index-5ded98a5.js";import{a as z,G as J}from"./index-d30dbc84.js";const O={key:0},Q={__name:"LRGrid",props:{keyProp:"",columnNum:{type:Number,default:2},apiPromise:Function,dataConvert:Function,dataHook:Function,disabledRefresh:{type:Boolean,default:!1},disabledLoadMore:{type:Boolean,default:!1},disabledEmpty:{type:Boolean,default:!1},externalDataFlag:{type:Boolean,default:!1},arrKey:{type:String,default:"data"}},setup(k,{expose:E}){const a=k,r=H([]),f=s(null),o=s(!1),_=s(!1),m=s(!1),u=s(!1),i=s(!1),x=s(null);N(()=>{a.externalDataFlag||(P(),!a.disabledLoadMore&&window.addEventListener("scroll",B,{passive:!0}))}),F(()=>{a.externalDataFlag||a.disabledLoadMore||window.removeEventListener("scroll",B,{passive:!0})});const L=S(()=>a.externalDataFlag?a.externalDataFlag:a.disabledRefresh);function B(){let t=x.value.clientHeight,l=document.documentElement.clientHeight,n=document.documentElement.scrollTop;n===0&&(t=1e4),t<=l+n&&g(!1)}function g(t){if(o.value||m.value)return;if(t)i.value=!1,u.value=!1,o.value=!0,m.value=!1;else{if(u.value)return;o.value=!1,m.value=!0}let l;t?l=1:f.value&&(l=Number(f.value.current_page)+1);const n=()=>{o.value=!1,_.value=!1,m.value=!1;const e=f.value;e?(u.value=Number(e.current_page)>=e.last_page&&y(e.data)<e.per_page||y(e.data)===0,u.value):u.value=!0},p=e=>a.dataConvert?a.dataConvert(e):e;a.apiPromise(l.toString()).then(e=>{if(f.value=e,e){const d=e[a.arrKey];o.value?(y(d)<=0&&(i.value=!0),r.value=p(d)):(r.value.push(...p(d)),M(r)),n(),t&&a.dataHook&&a.dataHook(e)}else o.value&&(i.value=!0),n()})}const P=()=>{g(!0)};return E({refresh:P,setData:t=>{r.value=t}}),(t,l)=>{const n=z,p=J,e=U,d=$;return v(),h("div",{ref_key:"scrollContainer",ref:x},[b(d,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=c=>_.value=c),onRefresh:l[1]||(l[1]=c=>g(!0)),disabled:L.value},{default:R(()=>[w(b(p,{border:!1,"column-num":a.columnNum,gutter:0},{default:R(()=>[(v(!0),h(G,null,V(r.value,c=>(v(),A(n,{key:c[k.keyProp]},{default:R(()=>[I(t.$slots,"default",K({ref_for:!0},c),void 0,!0)]),_:2},1024))),128))]),_:3},8,["column-num"]),[[D,!i.value]]),a.disabledEmpty?T("",!0):(v(),h("div",O,[w(b(e,{image:"/src/assets/images/icon/ic_empty_no_data_note.png",description:"暂无数据，请稍后再试～",class:"empty_img"},null,512),[[D,i.value]])]))]),_:3},8,["modelValue","disabled"])],512)}}},Y=C(Q,[["__scopeId","data-v-0835e9a1"]]);export{Y as _};
