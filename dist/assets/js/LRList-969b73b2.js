import{_ as C,H as F,r as o,Q as w,C as M,o as g,c as y,d as b,w as P,J as R,F as S,N as E,O as N,b9 as V,x as H,M as B,B as G,R as h,bc as $}from"./index-14c7bbbb.js";import{E as z,P as A}from"./index-5ded98a5.js";import{L as K}from"./index-12b6e44e.js";const U={key:0},I={__name:"LRList",props:{keyProp:"",apiPromise:Function,dataConvert:Function,dataHook:Function,disabledRefresh:{type:Boolean,default:!1},disabledLoadMore:{type:Boolean,default:!1},disabledEmpty:{type:Boolean,default:!1},externalDataFlag:{type:Boolean,default:!1},arrKey:{type:String,default:"data"},isGrid:{type:Boolean,default:!1}},setup(x,{expose:k}){const a=x,u=F([]),d=o(null),n=o(!1),c=o(!1),f=o(!1),m=o(!1),r=o(!1),i=o(!1);w(()=>{a.externalDataFlag||L()});const D=M(()=>a.externalDataFlag?a.externalDataFlag:a.disabledRefresh);function _(l){if(n.value||f.value)return;if(l)i.value=!1,n.value=!0,f.value=!1,r.value=!1;else{if(r.value)return;n.value=!1,f.value=!0}let t;l?t=1:d.value&&(t=Number(d.value.current_page)+1);const v=()=>{n.value=!1,c.value=!1,f.value=!1,m.value=!1;const e=d.value;e?(r.value=Number(e.current_page)>=e.last_page&&h(e.data)<e.per_page||h(e.data)===0,r.value):r.value=!0},p=e=>a.dataConvert?a.dataConvert(e):e;a.apiPromise(t.toString()).then(e=>{if(d.value=e,e){const s=e[a.arrKey];n.value?(h(s)<=0&&(i.value=!0),u.value=p(s)):(u.value.push(...p(s)),$(u)),v(),l&&a.dataHook&&a.dataHook(e)}else n.value&&(i.value=!0),v()})}const L=()=>{_(!0)};return k({refresh:L,setData:l=>{u.value=l}}),(l,t)=>{const v=K,p=z,e=A;return g(),y("div",null,[b(e,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=s=>c.value=s),onRefresh:t[3]||(t[3]=s=>_(!0)),disabled:D.value},{default:P(()=>[R(b(v,{class:S({grid_layout:a.isGrid}),disabled:a.disabledLoadMore,onLoad:t[0]||(t[0]=s=>_(!1)),loading:m.value,"onUpdate:loading":t[1]||(t[1]=s=>m.value=s),finished:r.value,"finished-text":a.isGrid?"":"没有更多了","immediate-check":!1,offset:"300"},{default:P(()=>[(g(!0),y(E,null,N(u.value,s=>V(l.$slots,"default",H({key:s[x.keyProp],ref_for:!0},s),void 0,!0)),128))]),_:3},8,["class","disabled","loading","finished","finished-text"]),[[B,!i.value]]),a.disabledEmpty?G("",!0):(g(),y("div",U,[R(b(p,{image:"/src/assets/images/icon/ic_empty_no_data_note.png",description:"暂无数据，请稍后再试～",class:"empty_img"},null,512),[[B,i.value]])]))]),_:3},8,["modelValue","disabled"])])}}},q=C(I,[["__scopeId","data-v-5a656a06"]]);export{q as _};
