import{_ as N,x as S,r as n,Q as C,aS as F,D as G,R as y,bp as M,o as v,c as h,d as b,w as R,ab as B,M as V,N as A,h as I,aG as K,y as T,aj as D,H as U}from"./index-2eecf243.js";import{i as $,E as j,P as z}from"./ic_empty_no_data_note-5031694c.js";import{a as Q,G as q}from"./index-2bb0c41e.js";const J={key:0},O={__name:"LRGrid",props:{keyProp:"",columnNum:{type:Number,default:2},apiPromise:Function,dataConvert:Function,dataHook:Function,disabledRefresh:{type:Boolean,default:!1},disabledLoadMore:{type:Boolean,default:!1},disabledEmpty:{type:Boolean,default:!1},externalDataFlag:{type:Boolean,default:!1},arrKey:{type:String,default:"data"}},setup(k,{expose:E}){const a=k,r=S([]),c=n(null),s=n(!1),_=n(!1),m=n(!1),u=n(!1),i=n(!1),x=n(null),L=n($);C(()=>{a.externalDataFlag||(w(),!a.disabledLoadMore&&window.addEventListener("scroll",P,{passive:!0}))}),F(()=>{a.externalDataFlag||a.disabledLoadMore||window.removeEventListener("scroll",P,{passive:!0})});const H=G(()=>a.externalDataFlag?a.externalDataFlag:a.disabledRefresh);function P(){let t=x.value.clientHeight,l=document.documentElement.clientHeight,o=document.documentElement.scrollTop;o===0&&(t=1e4),t<=l+o&&g(!1)}function g(t){if(s.value||m.value)return;if(t)i.value=!1,u.value=!1,s.value=!0,m.value=!1;else{if(u.value)return;s.value=!1,m.value=!0}let l;t?l=1:c.value&&(l=Number(c.value.current_page)+1);const o=()=>{s.value=!1,_.value=!1,m.value=!1;const e=c.value;e?(u.value=Number(e.current_page)>=e.last_page&&y(e.data)<e.per_page||y(e.data)===0,u.value):u.value=!0},p=e=>a.dataConvert?a.dataConvert(e):e;a.apiPromise(l.toString()).then(e=>{if(c.value=e,e){const d=e[a.arrKey];s.value?(y(d)<=0&&(i.value=!0),r.value=p(d)):(r.value.push(...p(d)),M(r)),o(),t&&a.dataHook&&a.dataHook(e)}else s.value&&(i.value=!0),o()})}const w=()=>{g(!0)};return E({refresh:w,setData:t=>{r.value=t}}),(t,l)=>{const o=Q,p=q,e=j,d=z;return v(),h("div",{ref_key:"scrollContainer",ref:x},[b(d,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=f=>_.value=f),onRefresh:l[1]||(l[1]=f=>g(!0)),disabled:H.value},{default:R(()=>[B(b(p,{border:!1,"column-num":a.columnNum,gutter:0},{default:R(()=>[(v(!0),h(V,null,A(r.value,f=>(v(),I(o,{key:f[k.keyProp]},{default:R(()=>[K(t.$slots,"default",T({ref_for:!0},f),void 0,!0)]),_:2},1024))),128))]),_:3},8,["column-num"]),[[D,!i.value]]),a.disabledEmpty?U("",!0):(v(),h("div",J,[B(b(e,{image:L.value,description:"暂无数据，请稍后再试～",class:"empty_img"},null,8,["image"]),[[D,i.value]])]))]),_:3},8,["modelValue","disabled"])],512)}}},ee=N(O,[["__scopeId","data-v-8303c0f3"]]);export{ee as _};
