import{_ as C,x as F,r as l,Q as M,D as S,o as g,c as y,d as b,w as P,ab as R,J as E,M as N,N as V,aG as G,y as H,aj as k,H as $,R as h,bp as z}from"./index-7cd15725.js";import{i as A,E as K,P as U}from"./ic_empty_no_data_note-b651d8f8.js";import{L as j}from"./index-dbf023d0.js";const I={key:0},J={__name:"LRList",props:{keyProp:"",apiPromise:Function,dataConvert:Function,dataHook:Function,disabledRefresh:{type:Boolean,default:!1},disabledLoadMore:{type:Boolean,default:!1},disabledEmpty:{type:Boolean,default:!1},externalDataFlag:{type:Boolean,default:!1},arrKey:{type:String,default:"data"},isGrid:{type:Boolean,default:!1}},setup(x,{expose:B}){const a=x,u=F([]),d=l(null),n=l(!1),c=l(!1),f=l(!1),m=l(!1),r=l(!1),i=l(!1),D=l(A);M(()=>{a.externalDataFlag||L()});const w=S(()=>a.externalDataFlag?a.externalDataFlag:a.disabledRefresh);function _(o){if(n.value||f.value)return;if(o)i.value=!1,n.value=!0,f.value=!1,r.value=!1;else{if(r.value)return;n.value=!1,f.value=!0}let t;o?t=1:d.value&&(t=Number(d.value.current_page)+1);const v=()=>{n.value=!1,c.value=!1,f.value=!1,m.value=!1;const e=d.value;e?(r.value=Number(e.current_page)>=e.last_page&&h(e.data)<e.per_page||h(e.data)===0,r.value):r.value=!0},p=e=>a.dataConvert?a.dataConvert(e):e;a.apiPromise(t.toString()).then(e=>{if(d.value=e,e){const s=e[a.arrKey];n.value?(h(s)<=0&&(i.value=!0),u.value=p(s)):(u.value.push(...p(s)),z(u)),v(),o&&a.dataHook&&a.dataHook(e)}else n.value&&(i.value=!0),v()})}const L=()=>{_(!0)};return B({refresh:L,setData:o=>{u.value=o}}),(o,t)=>{const v=j,p=K,e=U;return g(),y("div",null,[b(e,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=s=>c.value=s),onRefresh:t[3]||(t[3]=s=>_(!0)),disabled:w.value},{default:P(()=>[R(b(v,{class:E({grid_layout:a.isGrid}),disabled:a.disabledLoadMore,onLoad:t[0]||(t[0]=s=>_(!1)),loading:m.value,"onUpdate:loading":t[1]||(t[1]=s=>m.value=s),finished:r.value,"finished-text":a.isGrid?"":"没有更多了","immediate-check":!1,offset:"300"},{default:P(()=>[(g(!0),y(N,null,V(u.value,s=>G(o.$slots,"default",H({key:s[x.keyProp],ref_for:!0},s),void 0,!0)),128))]),_:3},8,["class","disabled","loading","finished","finished-text"]),[[k,!i.value]]),a.disabledEmpty?$("",!0):(g(),y("div",I,[R(b(p,{image:D.value,description:"暂无数据，请稍后再试～",class:"empty_img"},null,8,["image"]),[[k,i.value]])]))]),_:3},8,["modelValue","disabled"])])}}},W=C(J,[["__scopeId","data-v-196549ee"]]);export{W as _};
